<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>SEL0359 - Controle Digital</title>

		<link rel="stylesheet" href="../dist/reset.css">
		<link rel="stylesheet" href="../dist/reveal.css">
		<link rel="stylesheet" href="../dist/theme/white.css" id="theme">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
		
		<!-- and it's easy to individually load additional languages -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/arduino.min.js"></script>
		
		<script>hljs.highlightAll();</script>
		
		<link rel="stylesheet" href="../style.css">
	</head>
	<body>
		
		<div class="reveal">
			<div class="slides">
				
				<section data-hide-slide-number="true" data-transition="slide">
					<div class="logo"><img src="../images/sel.png"/> </div>
					<div class="logo2"><img src="../images/usp.png"/> </div>
					<div class="title">
					<h2>Aula 9: <br>Espaço de Estados - parte 2</h2>
					</div>
					<div class="author">
					<h3>Prof. Marcos Rogério Fernandes</h3>
				</div>
					<div class="advisor">
					
					<p style="text-align: center;font-size: 0.8em;">31 de outubro de 2024</p>
				</div>

				</section>
				



						

			<section>
			
			<div class="slide-title">
				<h2>Objetivos</h2>
			</div>
			<div class="slide-content">
				<p>Os objetivos dessa aula são entender:
						<ul>
						<li>Controlabilidade;</li>
						<li>Observabilidade;</li>
						<li>Realimentação de estados;</li>
						<li>Observadores de estado;</li>
						<li>Controle com rastreamento;</li>
					</p>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Modelo em espaço de estados em tempo discreto</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">

				$$
				\begin{aligned} 
				x_{k+1}&=A_dx_k+B_du_k\\ 
				y_k&=Hx_k+Du_k
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Modelo em espaço de estados em tempo discreto</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<img src="../images/modelo_ss_discreto.png" width="1000">
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Solução da equação de estados em tempo discreto</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">

				$$
				\begin{aligned} 
				x_k=A_d^kx_0+\sum_{j=0}^{k-1}A_d^{k-j-1}B_d u_j, \quad k=1,2,3,\ldots
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Solução da equação de estados em tempo discreto</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">
				Saída:

				$$
				\begin{aligned} 
				y_k=HA_d^kx_0+H\sum_{j=0}^{k-1}A_d^{k-j-1}B_d u_j+Du_k, \\k=1,2,3,\ldots
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>



		
		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">
				É possível levar o sistema para qualquer estado desejado em um tempo finito?
			</p>
			<img src="../images/controlabilidade.png" width="500">
	
			</center>
					</div>

		</section>

		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">
				É possível levar o sistema para qualquer estado desejado em um tempo finito?
			</p>
			$$
\text{Existe uma sequência de ações de controle } u_0,u_1,\ldots,u_k \\ \text{ tal que: } \\x_k=A_d^kx_0+\sum_{j=0}^{k-1}A_d^{k-1-j}Bu_j
			$$
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
				$$					
			\begin{aligned}
					x_1&=Ax_0+Bu_0\\
					x_2&=A^2x_0+ABu_0+Bu_1\\
					x_3&=A^3x_0+A^2Bu_0+ABu_1+Bu_2\\
					\vdots& \\
					x_k&=A^kx_0+A^{k-1}Bu_0+\cdots+ABu_{k-2}+Bu_{k-1}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
				$$					
			\begin{aligned}
					x_1-Ax_0&=Bu_0\\
					x_2-A^2x_0&=ABu_0+Bu_1\\
					x_3-A^3x_0&=A^2Bu_0+ABu_1+Bu_2\\
					\vdots& \\
					x_k-A^kx_0&=A^{k-1}Bu_0+\cdots+ABu_{k-2}+Bu_{k-1}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
				$$					
			\begin{aligned}
			\begin{bmatrix}
			x_1-Ax_0\\
			x_2-A^2x_0\\
			x_3-A^3x_0\\
			\vdots\\
			x_k-A^kx_0
			\end{bmatrix}=\begin{bmatrix}
					Bu_0\\
					ABu_0+Bu_1\\
					A^2Bu_0+ABu_1+Bu_2\\
					\vdots \\
					A^{k-1}Bu_0+\cdots+ABu_{k-2}+Bu_{k-1}
					\end{bmatrix}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
				$$					
			\begin{aligned}
			\begin{bmatrix}
			x_1-Ax_0\\
			x_2-A^2x_0\\
			x_3-A^3x_0\\
			\vdots\\
			x_k-A^kx_0
			\end{bmatrix}=\begin{bmatrix}
					B & 0 & 0 & \cdots & 0\\
					AB & B & 0 & \cdots & 0\\
					A^2B & AB & B & \cdots & 0\\
					\vdots \\
					A^{k-1}B& A^{k-2}B & A^{k-3}B & \cdots &B
					\end{bmatrix}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
				$$					
			\begin{aligned}
			
			x_k-A^kx_0
			=\begin{bmatrix}
					
					A^{k-1}B& A^{k-2}B & A^{k-3}B & \cdots &B
					\end{bmatrix}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
				$$					
			\begin{aligned}
			
			x_k-A^kx_0
			=\underbrace{\begin{bmatrix}		
					A^{k-1}B& A^{k-2}B & A^{k-3}B & \cdots &B
					\end{bmatrix}}_{\mathcal{C}}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
				$$					
			\begin{aligned}
			
			x_k-A^kx_0
			=\mathcal{C}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}
		\end{aligned}
	$$
			</center>
					</div>

		</section>

		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					Suponha $x_k\in\mathbb{R}^n$ e $u_k\in\mathbb{R}^m$, então
				$$					
			\begin{aligned}
			
			(x_k-A^kx_0)_{n\times 1}
			=\mathcal{C}_{n\times mk}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}_{mk\times 1}
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					Suponha $x_k\in\mathbb{R}^n$ e $u_k\in\mathbb{R}^m$, então
				$$					
			\begin{aligned}
			
			\underbrace{(x_k-A^kx_0)_{n\times 1}}_{\Delta x}
			=\mathcal{C}_{n\times mk}\begin{bmatrix}
					u_0\\
					u_1\\
					u_2\\
					\vdots \\
					u_{k-1}
					\end{bmatrix}_{mk\times 1}
		\end{aligned}
	$$
			</center>
					</div>

		</section>



		<!-- <section>
			
			<div class="slide-title">
				<h2>Revisão de Álgebra Linear</h2>
			</div>
			<div class="slide-content">
				<center>
					Suponha uma matriz $X\in\mathbb{R}^{n\times m}$, então 
<p class="lightup2">
				$$					
			\mathcal{Range}\{X\}=\{y\in\mathbb{R}^n: y=X\eta,\quad \forall \eta \in\mathbb{R^m}\}\subseteq \mathbb{R}^n
		
	$$
</p>

<p class="lightup2">
	$$					
\text{rank}(X)=\text{n° linhas ou colunas LI}

$$
</p>
<p class="lightup2">
	Rank Completo:
	$$					
\text{rank}(X)=\min(n,m)

$$
</p>
	
			</center>


					</div>

		</section> -->



		<!-- <section>
			
			<div class="slide-title">
				<h2>Controlabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
<p class="lightup2">
				$$					
			\Delta x\in \mathcal{Range}\{\mathcal{C}\}
		
	$$
</p>
	<img src="../images/controlabilidade2.png" width="620">
			</center>


					</div>

		</section> -->


	

		
					
		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="lightup">
					Portanto, se $\text{rank}(\mathcal{C})=n$ então existe uma sequência $\{u_j\}_{j=0}^{k-1}$ que leva o sistema do estado $x_0$ até $x_k$.
				</p>
						
				<img src="../images/controlabilidade2.png" width="600">
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Controlabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="">
					Se $u_k\in\mathbb{R}$ (single-input), então é suficiente que exista $u_0,u_1,\ldots,u_{n-1}$ ações de controle para levar o sistema para qualquer estado. Além do mais, se $\text{rank}(\mathcal{C})$=n, então existe
					$\mathcal{C}^{-1}$ e pode-se obter a sequência de ações de controle na forma
				</p>
				$$					
			\begin{aligned}
			
			\begin{bmatrix}
			u_0\\
			u_1\\
			u_2\\
			\vdots \\
			u_{n-1}
			\end{bmatrix}= \mathcal{C}^{-1}\Delta x
			
		\end{aligned}
	$$
			</center>
					</div>

		</section>


		<!-- <section>
			
			<div class="slide-title">
				<h2>Controlabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="">
					Se $u_k\in\mathbb{R^m}$ (multiple-input), com $m\le n$, então é suficiente que exista $u_0,u_1,\ldots,u_{\lceil\frac{n}{m}\rceil-1}$ ações de controle para levar o sistema para qualquer estado. Além do mais, se $\text{rank}(\mathcal{C})$=n, então pode-se obter a sequência de ações de controle na forma
				</p>
				$					
	
			
			\begin{bmatrix}
			u_0\\
			u_1\\
			u_2\\
			\vdots \\
			u_{\lceil\frac{n}{m}\rceil-1}
			\end{bmatrix}= (\mathcal{C}^\trp \mathcal{C})^{-1}\mathcal{C}^\trp \Delta x
			

	$
			</center>
					</div>

		</section> -->



		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup">
				É possível conhecer a condição inicial do sistema dado um conjunto finito de medidas da saída e o sinal de entrada?
			</p>
		
			<img src="../images/observabilidade.png" width="600">
			
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
			$$
			\begin{aligned} 
			y_0&=Hx_0+Du_0\\ 
		    y_1&=Hx_1+Du_1=HAx_0+HBu_0+Du_1\\
			\vdots \\
			y_k&=HA^kx_0+HA^{k-1}Bu_0+\cdots+HBu_{k-1}+Du_k
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
			$$
			\begin{aligned} 
			y_0-Du_0&=Hx_0\\ 
		    y_1-HBu_0-Du_1&=HAx_0\\
			\vdots \\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k&=HA^kx_0
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>



		
		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
			$$
			\begin{aligned} 
			\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}
			&=
			\begin{bmatrix}
			Hx_0\\ 
		    HAx_0\\
			\vdots \\
			HA^kx_0
			\end{bmatrix}
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
			$$
			\begin{aligned} 
			\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}
			&=
			\begin{bmatrix}
			H\\ 
		    HA\\
			\vdots \\
			HA^k
			\end{bmatrix}x_0
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
			$$
			\begin{aligned} 
			\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}
			&=
			\underbrace{\begin{bmatrix}
			H\\ 
		    HA\\
			\vdots \\
			HA^k
			\end{bmatrix}}_{\mathcal{O}}x_0
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>		
			$$
			\begin{aligned} 
			\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}
			&=
			\mathcal{O}x_0
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
	
Supondo $x_k\in \mathbb{R}^n$ e $y_k\in\mathbb{R}^p$, então									
			$$
			\begin{aligned} 
			\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}_{p(k+1)\times 1}
			&=
			\mathcal{O}_{p(k+1)\times n}x_0
			\end{aligned}
			$$
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
Supondo $x_k\in \mathbb{R}^n$ e $y_k\in\mathbb{R}^p$, então									
			$$
			\begin{aligned} 
			\underbrace{\begin{bmatrix}
			y_0-Du_0\\
			y_1-HBu_0-Du_1\\
			\vdots\\
			y_k-H\sum_{j=0}^{k-1}A^{k-1-j}Bu_j-Du_k
			\end{bmatrix}}_{\Delta y}
			&=
			\mathcal{O}_{p(k+1)\times n}x_0
			\end{aligned}
			$$

	
			</center>
					</div>

		</section>


		<!-- <section>
			
			<div class="slide-title">
				<h2>Observabilidade</h2>
			</div>
			<div class="slide-content">
				<center>
<p class="lightup2">
				$$					
			\Delta y\in \mathcal{Range}\{\mathcal{O}\}
		
	$$
</p>
	<img src="../images/observabilidade.png" width="620">
			</center>


					</div>

		</section> -->




		
					
		<section>
			
			<div class="slide-title">
				<h2>Observabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="lightup">
					Portanto, se $\text{rank}(\mathcal{O})=n$ então é possível reconstruir $x_0$ através das medições $\{y_j\}_{j=0}^{k}$ e $\{u_j\}_{j=0}^{k}$.
				</p>
						
				<img src="../images/observabilidade.png" width="600">
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="">
					Se $y_k\in\mathbb{R}$ (single-output), então é suficiente um conjunto $y_0,y_1,\ldots,y_{n-1}$ medições para reconstruir $x_0$. Além do mais, se $\text{rank}(\mathcal{O})=n$, então existe
					$\mathcal{O}^{-1}$ e pode-se obter $x_0$ na forma
				</p>
				<p class="lightup">
				$$					
			\begin{aligned}
			
			x_0= \mathcal{O}^{-1}\Delta y
			
		\end{aligned}
	$$
</p>
			</center>
					</div>

		</section>

<!-- 
		<section>
			
			<div class="slide-title">
				<h2>Observabilidade Completa</h2>
			</div>
			<div class="slide-content">

				<center>
					<p class="">
					Se $y_k\in\mathbb{R}^p$ (multiple-output), com $p\le n$, então é suficiente que existam $y_0,y_1,\ldots,y_{\lceil\frac{n}{p}\rceil-1}$ medições para obter $x_0$. Além do mais, se $\text{rank}(\mathcal{O})=n$, então pode-se obter $x_0$ na forma
				</p>
				<p class="lightup">
	$$						
			x_0= (\mathcal{O}^\trp \mathcal{O})^{-1}\mathcal{O}^\trp \Delta y
	$$
</p>
			</center>
					</div>

		</section> -->





		<section>
			
			<div class="slide-title">
				<h2>Projeto de Controladores em Espaço de Estados</h2>
			</div>
			<div class="slide-content">

				<center>
				<img src="../images/design_process3.png" width="550">
			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Controle via Realimentação de Estados</h2>
			</div>
			<div class="slide-content">

				<center>
				
				<img src="../images/state_feedback.png" width="650">
				<p class="lightup2">
$$
u_k=-Kx_k
$$
</p>
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Exemplo: Pêndulo Invertido</h2>
			</div>
			<div class="slide-content">

				<center>
			
				<img src="../images/pendulo_invertido_planta.png" width="850">

			</center>
					</div>

		</section>


		
		


		<section>
			
			<div class="slide-title">
				<h2>Exemplo: Pêndulo Invertido</h2>
			</div>
			<div class="slide-content">

				<center>
			
				<img src="../images/pendulo_invertido_planta2.png" width="850">

			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Realimentação de Estados</h2>
			</div>
			<div class="slide-content">

				<center>
			
				<img src="../images/pendulo_invertido_planta3.png" width="700">

			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Realimentação de Estados</h2>
			</div>
			<div class="slide-content">

				<center>
			
				<img src="../images/pendulo_invertido_planta_statefeedback.png" width="750">

			</center>
					</div>

		</section>


	


		<section>
			
			<div class="slide-title">
				<h2>Controle via Realimentação de Estados</h2>
			</div>
			<div class="slide-content">

				<center>
				
				<p class="">
$$
x_{k+1}=Ax_k+Bu_k=Ax_k-BKx_k
$$
</p>
Portanto, a dinâmica em malha-fechada é
<p class="lightup">
	$$
	x_{k+1}=(A-BK)x_k
	$$
	</p>
	Assintoticamente estável se 
	$$
	|\lambda\{A-BK\}| < 1
	$$

			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
				<p class="">
					$$
					x_{k+1}=Ax_k+Bu_k
					$$
</p>
<p class="lightup">
	$$
	\Delta(A)=\det(\lambda I-A)
	$$
	</p>
	As raízes do polinômio $\Delta(A)$ são os <b>autovalores</b> de $A$:
	$$
	\lambda\{A\}=\{\lambda_i: \det(\lambda_iI-A)=0,i=1,\ldots,n\}
	$$

			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
				<p class="">
					$$
					x_{k+1}=Ax_k+Bu_k
					$$
</p>
<p class="lightup">
	$$
	\Delta(A)=\det(\lambda I-A)
	$$
	</p>
	Para <b>sistemas controláveis</b> os autovalores são iguais aos pólos da função de transferência!

			</center>
					</div>

		</section>


<!-- 
		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
				<p class="">
					
					$$
					\mathcal{Z}\{x_{k+1}\}=\mathcal{Z}\{Ax_k+Bu_k\}\\
					\mathcal{Z}\{y_k\}=\mathcal{Z}\{Hx_k+Du_k\}
					$$
					Considerando <b>condições iniciais nulas</b>, então,
					$$
							\Rightarrow X(z)=(zI-A)^{-1}BU(z)\\
							\Rightarrow Y(z)=\underbrace{(H(zI-A)^{-1}B+D)}_{\text{função de transferência}}U(z)
					$$
</p>


			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
				<p class="">
					$$
					\Rightarrow Y(z)=H(zI-A)^{-1}BU(z)
					$$
					Para sistemas SISO, tem-se
					<p class="lightup">
					$$
							\frac{Y(z)}{U(z)}=H(zI-A)^{-1}B+D
							
					$$
				</p>
</p>


			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p class="lightup">
						$$
								\frac{Y(z)}{U(z)}=H(zI-A)^{-1}B+D
								
						$$
					</p>
				<p class="">
				Uma vez que 
				$$
					M^{-1}=\frac{1}{\det(M)}Adj(M)
				$$
				
</p>


			</center>
					</div>

		</section>

		<section>
			
			<div class="slide-title">
				<h2>Equação Característica</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p class="lightup">
						$$
								\frac{Y(z)}{U(z)}=H(zI-A)^{-1}B+D
								
						$$
					</p>
				<p class="">
				então
				$$
				\frac{Y(z)}{U(z)}=\frac{1}{\det(zI-A)}HAdj(zI-A)B+D
				$$
				
</p>


			</center>
					</div>

		</section> -->

		
		<section>
			
			<div class="slide-title">
				<h2>Projeto por Alocação de Pólos</h2>
			</div>
			<div class="slide-content">

				<center>
				
					<p class="">
						$$
						x_{k+1}=Ax_k+Bu_k\\
						u_k=-Kx_k
						$$
	</p>
<p class="lightup">
	$$
	\Delta_d(A-BK)=(z-p_1)(z-p_2)\cdots(z-p_n)
	$$
	</p>
	em que $p_1,p_2,\ldots,p_n$ são os pólos desejados em malha fechada!

			</center>
					</div>

		</section>


			
		<section>
			
			<div class="slide-title">
				<h2>Projeto por Alocação de Pólos</h2>
			</div>
			<div class="slide-content">

				<center>
				
					<p class="">
						$$
						x_{k+1}=Ax_k+Bu_k\\
						u_k=-Kx_k
						$$
	</p>
<p class="lightup">
	$$
	\Delta_d(A-BK)=z^n+\beta_1z^{n-1}+\cdots+\beta_{n-1}z+\beta_n
	$$
	</p>
	em que $p_1,p_2,\ldots,p_n$ são os pólos desejados em malha fechada!

			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Forma Canônica Controlável</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p class="lightup">
						Função de transferência (SISO):
						$$
								\frac{Y(z)}{U(z)}=\frac{z^m+b_1z^{m-1}+\cdots+b_{m-1}z+b_m}{z^n+a_1z^{n-1}+\cdots+a_{n-1}z+a_n}, m\le n
								
						$$
					</p>
				<p class="">
				Se não ocorrer cancelamentos de zeros com pólos, então o sistema é controlável!				
</p>


			</center>
					</div>

		</section>


		
		<section>
			
			<div class="slide-title">
				<h2>Forma Canônica Controlável</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p class="lightup">
					    $$
								x_{k+1}=\begin{bmatrix}
								0 & 1 & 0 & \cdots & 0\\
								0 & 0 & 1 & \cdots & 0\\
								\vdots & \vdots & \vdots & \ddots & \vdots \\
								0 & 0 & 0 & \cdots & 1\\
								-a_n & -a_{n-1} & -a_{n-2} & \cdots & -a_1
								\end{bmatrix}x_k+\begin{bmatrix}
								0\\
								0\\
								\vdots\\
								0\\
								1
								\end{bmatrix}u_k
								
						$$
					</p>
				


			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Forma Canônica Controlável</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p class="">
						Dado as matrizes $A$ e $B$ na forma Canônica Controlável, tem-se
					    $$
							\det(\lambda I - (A-BK))=z^{n}+\beta_1z^{n-1}+\cdots+\beta_{n-1}z+\beta_n
						$$
					</p>
					o que resulta em
					<p class="lightup">
					$$
					K=\begin{bmatrix}
					(\beta_n-a_n) & (\beta_{n-1}-a_{n-1}) & \cdots & (\beta_1-a_1)
					\end{bmatrix}
					$$
				</p>
				


			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Equação de Ackermann (SISO)</h2>
			</div>
			<div class="slide-content">

				<center>	
					Dado a equação característica desejada:
					$$
\gamma(z)=z^{n}+\beta_1z^{n-1}+\cdots+\beta_{n-1}z+\beta_n
					$$
					então, o ganho de realimentação de estados é dado por:
					<p class=" lightup2">
					
					    $$
							K=\begin{bmatrix}
							0 & \cdots & 1
							\end{bmatrix}\mathcal{C}^{-1}\gamma(A)
						$$
					</p>
		obs: $\gamma(A)=A^{n}+\beta_1A^{n-1}+\cdots+\beta_{n-1}A+\beta_n I$
				


			</center>
					</div>

		</section>



		
		




		<section>
			
			<div class="slide-title">
				<h2>Exemplo:</h2>
			</div>
			<div class="slide-content">
				<center>
									
			$$
					x_{k+1}=\begin{bmatrix}
					0 & 1 \\
					-0.96 & -2
					\end{bmatrix}+\begin{bmatrix}0\\ 1\end{bmatrix}u_k
			$$

			Pólos desejados: $\lambda_1=0.8$ e $\lambda_2=0.9$.



			$$
			x_{k+1}=\begin{bmatrix}
			-1.2 & 1 \\
			0 & -0.8
			\end{bmatrix}+\begin{bmatrix}0.5\\ 1\end{bmatrix}u_k\\
			y_k=\begin{bmatrix}0.5 & 1\end{bmatrix}x_k
	$$


	Pólos desejados: $\lambda_1=0.8$ e $\lambda_2=0.9$.


			
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Observadores de Estado:</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
		<img src="../images/state_feedback.png" alt="">		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Observadores de Estado:</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
		<img src="../images/pendulo_invertido_planta_observer.png" width="800">		
		
	
			</center>
					</div>

		</section>


		

		<section>
			
			<div class="slide-title">
				<h2>Observadores de Estado:</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
		<img src="../images/state_observer2.png" width="750">		
		
	
			</center>
					</div>

		</section>

		<section>
			
			<div class="slide-title">
				<h2>Observadores de Estado:</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
		<img src="../images/state_observer3.png" width="950">		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Observadores de Estado:</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
		<img src="../images/state_observer4.png" width="950">		
		
	
			</center>
					</div>

		</section>



		
		<section>
			
			<div class="slide-title">
				<h2>Modelo em espaço de estados</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup2">
Sistema:
				$$
				\begin{aligned} 
				x_{k+1}&=A_dx_k+B_du_k\\ 
				y_k&=Hx_k+Du_k
				\end{aligned}
				$$
			</p>

			<p class="lightup2">
Observador
				$$
				\begin{aligned} 
				\hat{x}_{k+1}&=A_d\hat{x}_k+B_du_k+L(y_k-\hat{y}_k)\\ 
				\hat{y}_k&=H\hat{x}_k+Du_k
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Dinâmica do Erro de Estado</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="">
				$$
				\begin{aligned} 
				\varepsilon_{k+1}&=x_{k+1}-\hat{x}_{k+1}\\ 
				&=Ax_k+Bu_k-(A\hat{x}_k+Bu_k)+L(y_k-\hat{y}_k)\\
				&=A\varepsilon_{k}+L(Hx_k+Du_k-(H\hat{x}_k+Du_k))\\
				&=(A-LH)\varepsilon_k
				\end{aligned}
				$$
			</p>
			Portanto,
			<p class="lightup2">
			$$
				\varepsilon_{k+1}=(A-LH)\varepsilon_k
			$$
		</p>
		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Dinâmica do Erro de Estado</h2>
			</div>
			<div class="slide-content">
				<center>
					Logo, se 		
			<p class="lightup2">
				
			$$
				|\lambda\{A-LH\}| < 1
			$$
			
		</p>
		então o observador converge para o estado verdadeiro!

		<p>&nbsp;</p>
		<p class="lightup">
		Boa prática de projeto: a dinâmica do erro de estado do observador ser pelo menos 2x mais rápido que a dinâmica do sistema!
	</p>
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Equação de Ackermann (SISO)</h2>
			</div>
			<div class="slide-content">

				<center>	
					Dado a equação característica desejada p/ o observador:
					$$
\gamma(z)=z^{n}+\beta_1z^{n-1}+\cdots+\beta_{n-1}z+\beta_n
					$$
					então, o ganho do observador é dado por:
					<p class=" lightup2">
					
					    $$
							L=\gamma(A)\mathcal{O}^{-1}\begin{bmatrix}
							0 & 0 & \cdots & 1
							\end{bmatrix}^\trp 
						$$
					</p>
		obs: $\gamma(A)=A^{n}+\beta_1A^{n-1}+\cdots+\beta_{n-1}A+\beta_n I$
				


			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Exemplo de observador de estados</h2>
			</div>
			<div class="slide-content">

				<center>	
			<img src="../images/observador_estados.png" width="850">

			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento vs Regulação</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p>Regulação</p>
				<img src="../images/state_feedback_ref0.png" alt="">

			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento vs Regulação</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p>&nbsp;</p>
				<img src="../images/quadcopter.jpg" width="700">

			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento vs Regulação</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p>Rastreamento</p>
				<img src="../images/state_feedback_integrador.png" width="1100">
			
			</center>
					</div>

		</section>



		
		<section>
			
			<div class="slide-title">
				<h2>Rastreamento vs Regulação</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p>Rastreamento</p>
				<img src="../images/state_feedback_integrador2.png" width="1100">
			
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup2">
Sistema:
				$$
				\begin{aligned} 
				x_{k+1}&=A_dx_k+B_du_k\\ 
				y_k&=Hx_k+Du_k
				\end{aligned}
				$$
			</p>

			<p class="lightup2">
Integrador
				$$
				\begin{aligned} 
				m_{k+1}&=m_k+(r_k-y_k)\\ 
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup2">
Sistema:
				$$
				\begin{aligned} 
				x_{k+1}&=A_dx_k+B_du_k\\ 
				y_k&=Hx_k+Du_k
				\end{aligned}
				$$
			</p>

			<p class="lightup2">
Lei de controle:
				$$
				\begin{aligned} 
				u_k=-Kx_k+K_im_k
				\end{aligned}
				$$
			</p>
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup2">
Sistema:
				$$
				\begin{aligned} 
				x_{k+1}&=(A_d-B_dK)x_k+B_dK_im_k\\ 
				m_{k+1}&=m_k+r_k-y_k\\
				y_k&=Hx_k+Du_k
				\end{aligned}
				$$
			</p>

			Por simplicidade, suponha $D=0$.

			
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
			<p class="lightup2">
Sistema Aumentado:
				$$
				\begin{aligned} 
				\begin{bmatrix}
				x_{k+1}\\
				m_{k+1}
				\end{bmatrix}
				&=\begin{bmatrix}
				A_d-B_dK & B_dK_i \\
				-H & I
				\end{bmatrix}\begin{bmatrix}
				x_{k}\\
				m_{k}
				\end{bmatrix}+\begin{bmatrix}
				0\\
				I
				\end{bmatrix}
				r_k
				\end{aligned}
				$$
			</p>

			
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
			<p class="lightup2">
Sistema Aumentado:
				$$
				\begin{aligned} 
				\begin{bmatrix}
				x_{k+1}\\
				m_{k+1}
				\end{bmatrix}
				&=\Bigl(\begin{bmatrix}
				A_d & 0 \\
				-H & I
				\end{bmatrix}-\begin{bmatrix}
				B_d  \\
				0
				\end{bmatrix}\begin{bmatrix}
				K & -K_i
				\end{bmatrix}\Bigr)\begin{bmatrix}
				x_{k}\\
				m_{k}
				\end{bmatrix}+\begin{bmatrix}
				0\\
				I
				\end{bmatrix}
				r_k
				\end{aligned}
				$$
			</p>

			
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
			<p class="lightup2">
Sistema Aumentado:
				$$
				\begin{aligned} 
				\begin{bmatrix}
				x_{k+1}\\
				m_{k+1}
				\end{bmatrix}
				&=\Bigl(\underbrace{\begin{bmatrix}
				A_d & 0 \\
				-H & I
				\end{bmatrix}}_{\mathcal{A}}-\underbrace{\begin{bmatrix}
				B_d  \\
				0
				\end{bmatrix}}_{\mathcal{B}}\underbrace{\begin{bmatrix}
				K & -K_i
				\end{bmatrix}}_{\mathcal{K}}\Bigr)\begin{bmatrix}
				x_{k}\\
				m_{k}
				\end{bmatrix}+\begin{bmatrix}
				0\\
				I
				\end{bmatrix}
				r_k
				\end{aligned}
				$$
			</p>

			
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
					<p>&nbsp;</p>
									
			<p class="lightup2">
Sistema Aumentado:
				$$
				\begin{aligned} 
				\begin{bmatrix}
				x_{k+1}\\
				m_{k+1}
				\end{bmatrix}
				&=\Bigl(\mathcal{A}-\mathcal{B}\mathcal{K}\Bigr)\begin{bmatrix}
				x_{k}\\
				m_{k}
				\end{bmatrix}+\begin{bmatrix}
				0\\
				I
				\end{bmatrix}
				r_k
				\end{aligned}
				$$
			</p>

			Basta determinar o ganho $\mathcal{K}$ que torne o sistema aumentado estável!
			$$
			|\lambda\{\mathcal{A}-\mathcal{B}\mathcal{K}\}|<1
			$$
		
		
	
			</center>
					</div>

		</section>



		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">
				<center>
									
			<p class="lightup2">
Condição para rastreamento do sistema:
				$$
				\begin{aligned} 		
				\begin{bmatrix}
				I-A_d & -B_d \\
				H & 0
				\end{bmatrix}
				\end{aligned}
				$$
				precisa ter rank completo.
			</p>
Consequências:
<br>
			<ul>
				<li>Sistema original precisa ser controlável;</li>
				<li>Não pode possuir zeros em $z=1$;</li>
				<li>Matriz $H$ precisa ter rank completo de linhas;</li>
			</ul>
			
		
		
	
			</center>
					</div>

		</section>


		<section>
			
			<div class="slide-title">
				<h2>Rastreamento</h2>
			</div>
			<div class="slide-content">

				<center>	
					<p>Rastreamento</p>
				<img src="../images/state_feedback_integrador2.png" width="1100">
			
			</center>
					</div>

		</section>





		
	
	


			<section>
				<div class="slide-title">
					<h2>Próxima aula teórica</h2>
				</div>
				<div class="slide-content">
					<center>
						<p>Controle LQR</p>
						<p >
				$$
						J=\sum_{k=1}^\infty x_k^\trp Q x_k +u_k^\trp R u_k
				$$
			</p>
			
					</center>
				</div>

			</section>



			


			<section>
		
				<div class="slide-content">
					<center>
						<p>&nbsp;</p>
						<p>&nbsp;</p>
						<p>&nbsp;</p>
					<h2>Até a próxima aula!</h2>
				</center>
				</div>

			</section>

			




				<!------------------------>
			</div>
		</div>

		

		<script src="../dist/reveal.js"></script>
		<script src="../plugin/notes/notes.js"></script>
		<script src="../plugin/markdown/markdown.js"></script>
		<script src="../plugin/math/math.js"></script>
		<script src="../init.js"></script>
	</body>
</html>

